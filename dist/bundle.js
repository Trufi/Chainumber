!function e(t,i,s){function n(l,a){if(!i[l]){if(!t[l]){var r="function"==typeof require&&require;if(!a&&r)return r(l,!0);if(o)return o(l,!0);var c=new Error("Cannot find module '"+l+"'");throw c.code="MODULE_NOT_FOUND",c}var h=i[l]={exports:{}};t[l][0].call(h.exports,function(e){var i=t[l][1][e];return n(i?i:e)},h,h.exports,e,t,i,s)}return i[l].exports}for(var o="function"==typeof require&&require,l=0;l<s.length;l++)n(s[l]);return n}({1:[function(e){var t=e("./analytics"),i=e("./state"),s=e("./util");s.isMobile||s.addClass(document.body,"no-touch"),t.init();var n=document.getElementById("game"),o=new i;n.appendChild(o.element),o.runMainMenu()},{"./analytics":6,"./state":20,"./util":21}],2:[function(e,t){function i(e,t,i){this._targets=[],s.call(this,e,t,i)}var s=e("./hammer"),n=e("../util");i.prototype=Object.create(s.prototype),i.prototype.constructor=i,i.prototype._addTarget=function(e,t){var i=this.field.getBlock(e,t);i&&(this._targets.push(i),n.addClass(i.element,"_targetAbility"))},i.prototype._removeTargets=function(){this._targets.forEach(function(e){n.removeClass(e.element,"_targetAbility")}),this._targets=[]},i.prototype._beforeRun=function(){var e=this._block,t=e.x,i=e.y;this._addTarget(t,i),this._addTarget(t,i+1),this._addTarget(t,i-1),this._addTarget(t-1,i),this._addTarget(t+1,i)},i.prototype._run=function(){this._targets.forEach(function(e){this.field.blockRemove(e.id)},this),this.field.checkPositions()},i.prototype._afterRun=function(){this._block&&this._removeTargets()},t.exports=i},{"../util":21,"./hammer":3}],3:[function(e,t){function i(e,t,i){this.name=e,this.abilities=i,this.field=i.game.field,this.count=t.count||0,this.element=null,this._block=null,this.isActive=!1,this._isMouseDown=!1,this._createElement(),this._bindEvents(),this.updateCount()}var s=e("../analytics"),n=e("../util");i.prototype._createElement=function(){var e=document.createElement("div");e.className="ability__"+this.name,e.innerHTML='<div class="ability__border"></div><div class="ability__count"></div>',this.countElement=e.getElementsByClassName("ability__count")[0],this.element=e},i.prototype._bindEvents=function(){var e=n.isMobile?"touchend":"click";n.on(this.element,e,this._onClickHandler.bind(this))},i.prototype._onClickHandler=function(){0!=this.count&&(this.isActive?this.abilities.stopAbility(this.name):this.abilities.runAbility(this.name))},i.prototype.updateCount=function(e){this.countElement.innerHTML=this.count,0==this.count?n.addClass(this.element,"_no-count"):(n.removeClass(this.element,"_no-count"),e&&this._blink())},i.prototype._blink=function(){var e=this;n.addClass(this.element,"_blink"),setTimeout(function(){n.removeClass(e.element,"_blink")},350)},i.prototype.activate=function(){n.addClass(this.element,"_active");var e=n.isMobile?"touchstart":"mousedown",t=n.isMobile?"touchend":"mouseup",i=n.isMobile?"touchmove":"mousemove";this._fieldClickHandlerBind=this._fieldClickHandler.bind(this),this._fieldMouseDownHandlerBind=this._fieldMouseDownHandler.bind(this),this._bodyEndClickBind=this._bodyEndClick.bind(this),this._fieldMouseMoveHandlerBind=this._fieldMouseMoveHandler.bind(this),n.on(this.field.element,t,this._fieldClickHandlerBind),n.on(this.field.element,e,this._fieldMouseDownHandlerBind),n.on(document.body,t,this._bodyEndClickBind),n.on(this.field.element,i,this._fieldMouseMoveHandlerBind),this.isActive=!0},i.prototype.deactivate=function(){n.removeClass(this.element,"_active");var e=n.isMobile?"touchstart":"mousedown",t=n.isMobile?"touchend":"mouseup",i=n.isMobile?"touchmove":"mousemove";n.off(this.field.element,t,this._fieldClickHandlerBind),n.off(this.field.element,e,this._fieldMouseDownHandlerBind),n.off(document.body,t,this._bodyEndClickBind),n.off(this.field.element,i,this._fieldMouseMoveHandlerBind),this.isActive=!1},i.prototype._fieldMouseDownHandler=function(e){if(this._isMouseDown=!0,e.target&&"block__active"===e.target.className){var t=e.target.parentNode.getAttribute("data-id"),i=this.field.blocks[t];i&&(this._block=i,this._beforeRun())}},i.prototype._fieldClickHandler=function(){this._block&&(this._isMouseDown=!1,s.abilityUsed(this.name,this._block.value),this._run(),this.count--,this.updateCount(),this.abilities.game.saveState(),this.abilities.stopAbility(this.name))},i.prototype._bodyEndClick=function(){this._isMouseDown=!1,this._afterRun()},i.prototype._fieldMouseMoveHandler=function(e){var t,i,s,o;if(this._isMouseDown){if(n.isMobile){for(t=0;t<e.changedTouches.length;t++)if(s=e.changedTouches[t],i=document.elementFromPoint(s.clientX,s.clientY),i&&"block__active"===i.className){o=i.parentNode.getAttribute("data-id");break}}else{if(i=document.elementFromPoint(e.clientX,e.clientY),!i||"block__active"!==i.className)return;o=i.parentNode.getAttribute("data-id")}if(!o)return this._afterRun(),void(this._block=null);var l=this.field.blocks[o];l&&(this._afterRun(),this._block=l,this._beforeRun())}},i.prototype._beforeRun=function(){n.addClass(this._block.element,"_targetAbility")},i.prototype._run=function(){this.field.blockRemove(this._block.id),this.field.checkPositions()},i.prototype._afterRun=function(){this._block&&n.removeClass(this._block.element,"_targetAbility")},t.exports=i},{"../analytics":6,"../util":21}],4:[function(e,t){function i(e,t,i){this._targets=[],s.call(this,e,t,i)}var s=e("./hammer"),n=e("../util");i.prototype=Object.create(s.prototype),i.prototype.constructor=i,i.prototype._beforeRun=function(){var e=this._block.value;n.forEach(this.field.blocks,function(t){t.value===e&&(this._targets.push(t),n.addClass(t.element,"_targetAbility"))},this)},i.prototype._run=function(){this._targets.forEach(function(e){this.field.blockRemove(e.id)},this),this.field.checkPositions()},i.prototype._afterRun=function(){this._block&&(this._targets.forEach(function(e){n.removeClass(e.element,"_targetAbility")}),this._targets=[])},t.exports=i},{"../util":21,"./hammer":3}],5:[function(e,t){t.exports={hammer:e("./abilities/hammer"),bomb:e("./abilities/bomb"),lightning:e("./abilities/lightning")}},{"./abilities/bomb":2,"./abilities/hammer":3,"./abilities/lightning":4}],6:[function(e,t){function i(){return Math.round(1e17*Math.random())}function s(){n=o.getUnitID(),n||(n=i(),o.setUnitID(n))}var n,o=e("./saves");t.exports={init:function(){s(),ga("create","UA-61340943-1","auto"),ga("set","&uid",n),ga("set","dimension1",n),ga("send","pageview")},goalAchived:function(e){ga("send","event","game","goal achived",String(e))},abilityUsed:function(e,t){ga("send","event","game","ability used",String(e),t)},levelStarted:function(e){ga("send","event","game","level started",String(e))},levelResumed:function(e){ga("send","event","game","level resume",String(e))},levelRestart:function(e){ga("send","event","game","level restart",String(e))},maxScoreUp:function(e){ga("send","event","game","max score up",String(e))}}},{"./saves":19}],7:[function(e,t){function i(e,t){t=t||{},this.game=e,this.config=e.store,this.element=null,this.isEnable=!1,this._lastUpAbilityIndex=1,this._abilities={},this.currentAbility=null,this._initElements(),this._restoreData(t)}var s=e("../abilityModules"),n=e("../util");i.prototype._initElements=function(){var e=document.createElement("div");e.className="abilities",this.config.ability&&(n.forEach(this.config.ability,function(t,i){var n=new s[i](i,t,this);this._abilities[i]=n,e.appendChild(n.element)},this),this.isEnable=!0),this.element=e},i.prototype._restoreData=function(e){e&&(e.list&&n.forEach(e.list,function(e,t){this._abilities[t].count=e.count||0,this._abilities[t].updateCount()},this),this._lastUpAbilityIndex=e.lastUpAbilityIndex||1)},i.prototype.checkUp=function(){if(this.isEnable&&!(this.game.score<this.config.abilityPerScore*this._lastUpAbilityIndex)){var e,t,i=Math.floor(this.game.score/this.config.abilityPerScore-this._lastUpAbilityIndex+1),s=[];n.forEach(this.config.ability,function(e,t){s.push([t,e.ratio||1])});for(var o=0;i>o;o++)e=n.random(s),e&&(t=this._abilities[e],t.count++,t.updateCount(!0));this._lastUpAbilityIndex++,this.game.saveState()}},i.prototype.runAbility=function(e){this.currentAbility&&this._abilities[this.currentAbility].deactivate(),this._abilities[e].activate(),this.currentAbility=e},i.prototype.stopAbility=function(e){this.currentAbility==e&&(this._abilities[e].deactivate(),this.currentAbility=null)},i.prototype.getState=function(){var e={};return e.list={},n.forEach(this._abilities,function(t,i){e.list[i]={count:t.count}}),e.lastUpAbilityIndex=this._lastUpAbilityIndex,e},t.exports=i},{"../abilityModules":5,"../util":21}],8:[function(e,t){function i(e,t,i){this.id=++a,this.field=i,this.config=i.config,this.game=i.game,this.x=e,this.y=t,this.value=null,this.element=null,this.fieldHeight=s.field.height,this.width=s.field.width/this.config.field.size[0],this.height=s.field.height/this.config.field.size[1],this.widthText=null,this._setRandomValue(),this._createElement(),this._bindEvents()}var s=e("../gameConfig"),n=e("./colors"),o=e("../util"),l=[1,2,3,5,7,11,13],a=0,r={};i.prototype._createElement=function(){var e=document.createElement("div");e.className="block",e.style.transform="translate3d("+Math.floor(this.x*this.width)+"px,"+Math.floor(this.fieldHeight-(this.y+1)*this.height)+"px,0)",e.setAttribute("data-id",this.id);var t=document.createElement("div");t.className="block__inner",e.appendChild(t);var i=document.createElement("div");i.className="block__innerBorder",t.appendChild(i);var s=document.createElement("div");s.className="block__innerText",s.innerHTML=this.value,t.appendChild(s);var n=document.createElement("div");n.className="block__active",e.appendChild(n),this.innerElement=t,this.textElement=s,this.activeElement=n,this.element=e,this._updateColors()},i.prototype._setRandomValue=function(){this.value=o.random(this.config.numbers.possibleValues)},i.prototype._bindEvents=function(){o.isMobile?o.on(this.element,"touchstart",this._mouseDownHandler.bind(this)):(o.on(this.element,"mousedown",this._mouseDownHandler.bind(this)),o.on(this.activeElement,"mouseover",this._mouseOverHandler.bind(this)))},i.prototype._mouseDownHandler=function(e){e.preventDefault(),this.game.abilities.currentAbility||this.field.blockMouseDown(this.id)},i.prototype._mouseOverHandler=function(){this.field.blockMouseOver(this.id)},i.prototype._mouseOutHandler=function(){this.field.blockMouseOut(this.id)},i.prototype.changePosition=function(e,t){this.x=e,this.y=t,this.element.style.transform="translate3d("+Math.floor(this.x*this.width)+"px,"+Math.floor(this.fieldHeight-(this.y+1)*this.height)+"px,0)"},i.prototype._updateColors=function(){if(!r[this.value]){var e,t=[];for(e=l.length-1;e>0;e--)this.value%l[e]===0&&t.push({value:l[e],rgb:n[e].rgb,ratio:this.value/l[e]});var i;i=t.length?o.rgbSum(t):n[0].rgb,r[this.value]="rgb("+i.join(",")+")"}this.innerElement.style.backgroundColor=r[this.value]},i.prototype.changeValue=function(e){this.value=e,this.textElement.innerHTML=e;var t=this.value.toString().length;t>=5&&10>=t&&this.widthText!==t&&(this.widthText&&o.removeClass(this.element,"_len_"+t),o.addClass(this.element,"_len_"+t)),this._updateColors()},i.prototype.select=function(){o.addClass(this.element,"_selected")},i.prototype.unselect=function(){o.removeClass(this.element,"_selected")},i.prototype.animateCreate=function(){var e=this;o.addClass(this.element,"_blink"),setTimeout(function(){o.removeClass(e.element,"_blink")},15)},t.exports=i},{"../gameConfig":12,"../util":21,"./colors":9}],9:[function(e,t){t.exports=[{web:"#99b433",rgb:[154,180,51]},{web:"#DA532C",rgb:[218,83,44]},{web:"#1e7145",rgb:[30,113,69]},{web:"#2C89A0",rgb:[44,137,160]},{web:"#00AA88",rgb:[0,170,136]},{web:"#00d455",rgb:[0,212,85]},{web:"#ff2a2a",rgb:[255,42,42]},{web:"#CB5000",rgb:[203,80,0]}]},{}],10:[function(e,t){function i(e,t){t=t||{},this.game=e,this.config=e.store,this.blocks={},this._blocksXY={},this.size=this.config.field.size,this.selectedBlocks=[],this.selectedMode=!1,this.element=null,this._init(),this._createElement(),this._bindEvents(),this._restoreData(t)}var s=e("./block"),n=e("../util"),o=e("../gameConfig");i.prototype._init=function(){for(var e=0;e<this.size[0];e++){this._blocksXY[e]={};for(var t=0;t<this.size[1];t++)this.createBlock(e,t,!0)}},i.prototype._restoreData=function(e){if(e.blocks)for(var t=0;t<this.size[0];t++)for(var i=0;i<this.size[1];i++)this.blocks[this._blocksXY[t][i]].changeValue(e.blocks[t][i].value)},i.prototype.createBlock=function(e,t,i){var n=new s(e,t,this);this.blocks[n.id]=n,this._blocksXY[e][t]=n.id,i||(this.element.appendChild(n.element),n.animateCreate())},i.prototype._createElement=function(){var e=document.createDocumentFragment();this.canvas=document.createElement("canvas"),this.canvas.className="field__canvas",this.ctx=this.canvas.getContext("2d"),this.canvas.width=o.field.width,this.canvas.height=o.field.height,e.appendChild(this.canvas),n.forEach(this.blocks,function(t){e.appendChild(t.element)}),this.element=document.createElement("div"),this.element.className="field _width_"+this.size[0]+" _height_"+this.size[1],this.element.appendChild(e)},i.prototype._bindEvents=function(){n.isMobile?(n.on(document.body,"touchend",this._mouseUpHandler.bind(this)),n.on(document.body,"touchmove",this._touchMoveHandler.bind(this))):n.on(document.body,"mouseup",this._mouseUpHandler.bind(this))},i.prototype._touchMoveHandler=function(e){var t,i,s,n,o,l,a,r=this.blocks;for(l=0;l<e.changedTouches.length;l++)if(n=e.changedTouches[l],o=document.elementFromPoint(n.clientX,n.clientY),o&&-1!=o.className.indexOf("block__active")){for(s=Object.keys(r),a=0;a<s.length;a++)if(i=r[s[a]],i.activeElement===o){this.blockMouseOver(i.id),t=!0;break}if(t)break}},i.prototype._mouseUpHandler=function(){this.selectedMode&&(this.selectedMode=!1,this._runSelected(),n.forEach(this.blocks,function(e){e.unselect()}),this.game.updateChainSum(),this._clearPath())},i.prototype.blockMouseDown=function(e){this.selectedMode=!0,this.selectedBlocks=[e],this.blocks[e].select(),this.game.updateChainSum()},i.prototype._checkWithLast=function(e){var t=this.blocks[this.selectedBlocks[this.selectedBlocks.length-1]],i=this.blocks[e];return t.value==i.value&&Math.abs(t.x-i.x)<=1&&Math.abs(t.y-i.y)<=1},i.prototype.blockMouseOver=function(e){if(this.selectedMode){var t=this.selectedBlocks;if(-1==t.indexOf(e))this._checkWithLast(e)&&(t.push(e),this.blocks[e].select(),this.game.updateChainSum(),this._updatePath());else if(t[t.length-2]==e){var i=t.pop();this.blocks[i].unselect(),this.game.updateChainSum(),this._updatePath()}}},i.prototype._updatePath=function(){var e=this.ctx,t=o.field.height;this._clearPath(),e.beginPath(),e.strokeStyle=o.path.color,e.lineWidth=o.path.width,this.selectedBlocks.forEach(function(i,s){var n=this.blocks[i],o=(n.x+.5)*n.width,l=t-(n.y+.5)*n.height;0===s?e.moveTo(o,l):e.lineTo(o,l)},this),e.stroke()},i.prototype._clearPath=function(){this.ctx.clearRect(0,0,o.field.width,o.field.height)},i.prototype.blockMouseOut=function(){},i.prototype.blockRemove=function(e){var t=this.blocks[e];this.element.removeChild(t.element),this._blocksXY[t.x][t.y]=null,delete this.blocks[e]},i.prototype._runSelected=function(){if(!(this.selectedBlocks.length<this.config.chain.minLength)){this.game.updateScore();var e=this.selectedBlocks.pop(),t=this.blocks[e],i=t.value*(this.selectedBlocks.length+1);t.changeValue(i),this.selectedBlocks.forEach(this.blockRemove,this),this.checkPositions(),this.game.saveState()}},i.prototype.checkPositions=function(){var e=this,t=this._blocksXY,i=this.blocks;n.forEach(t,function(t){var s=[];n.forEach(t,function(e){e&&s.push(e)}),s.length!=e.size[1]&&s&&(s.sort(function(e,t){return i[e].y>i[t].y}),s.forEach(function(e,s){var n=i[e];n.y!=s&&(t[n.y]=null,n.changePosition(n.x,s),t[s]=e)}))}),this._addNewBlocks()},i.prototype._addNewBlocks=function(){for(var e=this._blocksXY,t=0;t<this.size[0];t++)for(var i=0;i<this.size[1];i++)e[t][i]||this.createBlock(t,i)},i.prototype.getState=function(){for(var e={blocks:{}},t=0;t<this.size[0];t++){e.blocks[t]={};for(var i=0;i<this.size[1];i++)e.blocks[t][i]={value:this.blocks[this._blocksXY[t][i]].value}}return e},i.prototype.getBlock=function(e,t){var i=this._blocksXY[e];if(!i)return null;var s=i[t];return s?this.blocks[s]:null},t.exports=i},{"../gameConfig":12,"../util":21,"./block":8}],11:[function(e,t){function i(e,t,i){i=i||{},this.name=e,this.state=t,this.store=s.get(e),this.score=i.score||0,this.field=new l(this,i.field),this.abilities=new n(this,i.abilities),this._createElement(),this._bindEvents()}var s=e("../levelStore"),n=e("./abilities"),o=e("../analytics"),l=e("./field"),a=e("../util");i.prototype._createElement=function(){var e=document.createElement("div");e.className="game";var t='<div class="game__header"><div class="game__levelName">Level: {{name}}</div><div class="game__score">{{score}}</div><div class="game__chainSum"></div><div class="game__maxScore">Max score: {{maxScore}}</div><div class="game__goal">{{goal}}</div></div><div class="game__body"><div class="game__win"><div class="game__winInner"><div class="game__winText">Congratulations!<br />You achived first goal of this level. Continue and get more scores or return to level menu?</div><div class="game__winButtons"><div class="game__winReturn">Continue</div></div></div></div><div class="game__field"></div></div><div class="game__footer"><div class="game__abilities"></div><div class="game__buttons"><div class="game__backButton">Back</div><div class="game__restartButton">Restart</div></div></div>';e.innerHTML=t.replace("{{score}}",this.score).replace("{{goal}}",this._getGoalText()).replace("{{name}}",this.name).replace("{{maxScore}}",this.store.maxScore),this.store.currentGoal>0&&a.addClass(e,"_win"),this.backButton=e.getElementsByClassName("game__backButton")[0],this.restartButton=e.getElementsByClassName("game__restartButton")[0],this.abilitiesElement=e.getElementsByClassName("game__abilities")[0],this.abilitiesElement.appendChild(this.abilities.element),this.goalElement=e.getElementsByClassName("game__goal")[0],this.scoreElement=e.getElementsByClassName("game__score")[0],this.chainSumElement=e.getElementsByClassName("game__chainSum")[0],this.maxScoreElement=e.getElementsByClassName("game__maxScore")[0],this.winReturnButton=e.getElementsByClassName("game__winReturn")[0],this.fieldElement=e.getElementsByClassName("game__field")[0],this.fieldElement.appendChild(this.field.element),this.element=e},i.prototype._bindEvents=function(){a.on(this.restartButton,"click",this.restart.bind(this)),a.on(this.backButton,"click",this._backToMenu.bind(this)),a.on(this.winReturnButton,"click",this._hideWinField.bind(this))},i.prototype._getGoalText=function(){return this.store.currentGoal<=3?this.store.goals[this.store.currentGoal]:""},i.prototype.restart=function(){this.score=0,this.scoreElement.innerHTML=0;var e=new l(this);this.fieldElement.replaceChild(e.element,this.field.element),this.field=e;var t=new n(this);this.abilitiesElement.replaceChild(t.element,this.abilities.element),this.abilities=t,this.saveState(),o.levelRestart(this.name)},i.prototype._backToMenu=function(){this.state.backFromLevel()},i.prototype.updateChainSum=function(){if(!this.field.selectedMode)return void a.removeClass(this.chainSumElement,"_showed");var e=this.field,t=e.blocks[e.selectedBlocks[0]].value||0;this.chainSumElement.innerHTML=t*e.selectedBlocks.length,a.addClass(this.chainSumElement,"_showed")},i.prototype.updateScore=function(){var e=this.field,t=e.blocks[e.selectedBlocks[0]].value||0,i=1+.2*(e.selectedBlocks.length-3);this.score+=Math.round(t*e.selectedBlocks.length*i),this.scoreElement.innerHTML=this.score,this.store.maxScore<this.score&&(this.store.maxScore=this.score,this.maxScoreElement.innerHTML="Max score: "+this.score,o.maxScoreUp(this.score)),this._checkGoal(),this.abilities.checkUp(),s.saveLevels()},i.prototype._checkGoal=function(){if(3!=this.store.currentGoal){var e=this.store;this.score>=e.winConditions[e.currentGoal]&&(e.currentGoal=Math.min(e.currentGoal+1,3),1==e.currentGoal&&this._win(),this.goalElement.innerHTML=this._getGoalText(),o.goalAchived(e.currentGoal))}},i.prototype._win=function(){a.addClass(this.element,"_win"),s.checkOpenLevels(),this._showWinField()},i.prototype.getState=function(){return{field:this.field.getState(),abilities:this.abilities.getState(),name:this.name,score:this.score}},i.prototype.saveState=function(){this.state.saveActiveLevel()},i.prototype._showWinField=function(){a.addClass(this.element,"_showWinField")},i.prototype._hideWinField=function(){a.removeClass(this.element,"_showWinField")},t.exports=i},{"../analytics":6,"../levelStore":15,"../util":21,"./abilities":7,"./field":10}],12:[function(e,t){t.exports={field:{width:500,height:500},path:{color:"rgba(255, 255, 255, 0.25)",width:10},progressBar:{width:490},levels:[1,2,3,4,5],minOpenLevels:5}},{}],13:[function(e,t){t.exports={1:{field:{size:[4,4]},numbers:{possibleValues:[[1,1],[2,1]]},chain:{minLength:3},winConditions:[1e3,3e3,6e3],goals:["Goal: 1000","Next goal: 3000","Last goal: 6000","Achieved!"],ability:{hammer:{count:1,ratio:10},bomb:{count:0,ratio:1},lightning:{count:0,ratio:1}},abilityPerScore:700},2:{field:{size:[5,5]},numbers:{possibleValues:[[1,1],[2,1],[3,1]]},chain:{minLength:3},winConditions:[1e4,25e3,5e4],goals:["Goal: 10000","Next goal: 25000","Last goal: 50000","Achieved!"],ability:{hammer:{count:1,ratio:10},bomb:{count:0,ratio:1},lightning:{count:0,ratio:1}},abilityPerScore:3e3},3:{field:{size:[4,4]},numbers:{possibleValues:[[3,1],[5,1],[7,1]]},chain:{minLength:3},winConditions:[500,1250,2500],goals:["Goal: 500","Next goal: 1250","Last goal: 2500","Achieved!"],ability:{hammer:{count:1,ratio:5},bomb:{count:0,ratio:1},lightning:{count:0,ratio:3}},abilityPerScore:150},4:{field:{size:[5,5]},numbers:{possibleValues:[[1,32],[3,32],[5,32],[135,4]]},chain:{minLength:3},winConditions:[8e3,32e3,15e4],goals:["Goal: 80000","Next goal: 32000","Last goal: 150000","Achieved!"],ability:{hammer:{count:1,ratio:5},bomb:{count:0,ratio:1},lightning:{count:0,ratio:1}},abilityPerScore:1e3},5:{field:{size:[5,5]},numbers:{possibleValues:[[1,1],[2,1],[3,1],[5,1]]},chain:{minLength:3},winConditions:[50,100,150],goals:["Goal: 50","Next goal: 100","Last goal: 150","Achieved!"],ability:{hammer:{count:2,ratio:5},bomb:{count:1,ratio:1},lightning:{count:1,ratio:1}},abilityPerScore:20}}},{}],14:[function(e,t){t.exports={1:e("./levels/1"),2:e("./levels/1"),3:e("./levels/1"),4:e("./levels/1"),5:e("./levels/1")}},{"./levels/1":16}],15:[function(e,t){function i(){var e=o.getLevels();n.levels.forEach(function(t){var i=s[t];i.name=t,e[t]=e[t]||{},i.currentGoal=e[t].currentGoal||0,i.maxScore=e[t].maxScore||0,r[t]=i}),a.checkOpenLevels()}var s=e("./levelConfig"),n=e("./gameConfig"),o=e("./saves"),l=e("./util"),a={},r={};a.get=function(e){return r[e]},a.checkOpenLevels=function(){var e=0;n.levels.forEach(function(t,i){var s=r[t];s.currentGoal>0&&e++,s.isOpen=i<e+n.minOpenLevels})},a.saveLevels=function(){var e={};l.forEach(r,function(t,i){e[i]={maxScore:t.maxScore,currentGoal:t.currentGoal}}),o.setLevels(e)},i(),t.exports=a},{"./gameConfig":12,"./levelConfig":13,"./saves":19,"./util":21}],16:[function(e,t){t.exports=e("../game/game")},{"../game/game":11}],17:[function(e,t){function i(e,t,i){this.levelMenu=e,this.name=t,this.store=s.get(this.name),this.element=document.createElement("div"),this.element.className="levelBlock _level_"+i%3;var o='<div class="levelBlock__score"></div><div class="levelBlock__text">{{name}}</div><div class="levelBlock__goal"><div class="levelBlock__goalPoint"></div><div class="levelBlock__goalPoint"></div><div class="levelBlock__goalPoint"></div></div>';this.element.innerHTML=o.replace("{{name}}",t),this.scoreElement=this.element.getElementsByClassName("levelBlock__score")[0],this.goalElements=this.element.getElementsByClassName("levelBlock__goalPoint"),this.isOpen=!1,n.on(this.element,"click",this._onClick.bind(this))}var s=e("../levelStore"),n=e("../util");i.prototype._onClick=function(){this.levelMenu.runLevel(this.name)},i.prototype.update=function(){for(var e=0;e<this.goalElements.length;e++)e+1<=this.store.currentGoal?n.addClass(this.goalElements[e],"_active"):n.removeClass(this.goalElements[e],"_active");this.scoreElement.innerHTML="Score: "+this.store.maxScore;var t=this.store.isOpen;this.isOpen!==t&&n.addClass(this.element,"_open")},t.exports=i},{"../levelStore":15,"../util":21}],18:[function(e,t){function i(e){this.state=e,this._isResumeActive=!1,this.levelBlocks={},this._createElement(),this._bindEvents(),this.update()}var s=e("../gameConfig"),n=e("../levelStore"),o=e("./levelBlock"),l=e("../util");i.prototype._createElement=function(){var e=document.createElement("div");e.className="mainMenu",e.innerHTML='<div class="mainMenu__header"><div class="mainMenu__title">Chainumber</div><div class="mainMenu__version">v0.0.1</div></div><div class="mainMenu__body"><div class="mainMenu__levelList"></div><div class="mainMenu__progress"><div class="mainMenu__progressBar"></div><div class="mainMenu__progressText"></div></div></div><div class="mainMenu__footer"><div class="mainMenu__resumeGame">Resume</div></div>';var t=e.getElementsByClassName("mainMenu__levelList")[0],i=document.createDocumentFragment();s.levels.forEach(function(e,t){var s=new o(this,e,t);this.levelBlocks[e]=s,i.appendChild(s.element)},this),t.appendChild(i),this.element=e,this.resumeGameButton=e.getElementsByClassName("mainMenu__resumeGame")[0],this.progressBarElement=e.getElementsByClassName("mainMenu__progressBar")[0],this.progressTextElement=e.getElementsByClassName("mainMenu__progressText")[0]},i.prototype._bindEvents=function(){l.on(this.resumeGameButton,"click",function(){this.state.resumeLevel()}.bind(this))},i.prototype.update=function(){l.forEach(this.levelBlocks,function(e){e.update()},this),this._updateProgress()},i.prototype._updateProgress=function(){var e=Object.keys(this.levelBlocks).length,t=3,i=0;l.forEach(this.levelBlocks,function(e){i+=e.store.currentGoal});var n=i/(e*t);this.progressBarElement.style.width=Math.floor(n*s.progressBar.width)+"px",this.progressTextElement.innerHTML=Math.floor(100*n)+"%"},i.prototype.resumeLevelActive=function(){this._isResumeActive||(this._isResumeActive=!0,l.addClass(this.element,"_activeLevel"))},i.prototype.runLevel=function(e){n.get(e).isOpen&&this.state.runLevel(e)},t.exports=i},{"../gameConfig":12,"../levelStore":15,"../util":21,"./levelBlock":17}],19:[function(e,t){function i(e){var t,i=localStorage.getItem(e);if(i)try{t=JSON.parse(i)}catch(s){t={}}else t={};return t}function s(e,t){localStorage.setItem(e,JSON.stringify(t))}var n={};n.getLevels=function(){return i("levels")},n.setLevels=function(e){s("levels",e)},n.setActiveLevel=function(e){s("activeLevel",e)},n.getActiveLevel=function(){return i("activeLevel")},n.setAbilities=function(e){s("abilities",e)},n.getAbilities=function(){return i("abilities")},n.setUnitID=function(e){localStorage.setItem("unitID",e)},n.getUnitID=function(e){return localStorage.getItem("unitID",e)},t.exports=n},{}],20:[function(e,t){function i(){this._activeElement=null,this._activeLevel=null,this.mainMenu=new s(this),this._createElement(),this._checkActiveLevel()}var s=e("./mainMenu/mainMenu"),n=e("./levelModules"),o=e("./analytics"),l=e("./saves"),a=e("./util");i.prototype._checkActiveLevel=function(){var e=l.getActiveLevel();Object.keys(e).length&&(this._activeLevel=new n[e.name](e.name,this,e),this.activeLevelElement.appendChild(this._activeLevel.element),this.mainMenu.resumeLevelActive())},i.prototype._createElement=function(){this.element=document.createElement("div"),this.element.className="state",this.element.innerHTML='<div class="state__mainMenu"></div><div class="state__activeLevel"></div>',this.mainMenuElement=this.element.getElementsByClassName("state__mainMenu")[0],this.mainMenuElement.appendChild(this.mainMenu.element),this.activeLevelElement=this.element.getElementsByClassName("state__activeLevel")[0]},i.prototype.saveActiveLevel=function(){this._activeLevel&&l.setActiveLevel(this._activeLevel.getState())},i.prototype._activate=function(e){this._activeElement!==e&&(this._activeElement&&a.removeClass(this._activeElement,"_showed"),a.addClass(e,"_showed"),this._activeElement=e)},i.prototype.runMainMenu=function(){this.mainMenu.update(),this._activate(this.mainMenuElement)},i.prototype.runLevel=function(e){if(this._activeLevel&&this._activeLevel.name==e)return this.resumeLevel();this.mainMenu.resumeLevelActive();var t=new n[e](e,this);this._activeLevel?this.activeLevelElement.replaceChild(t.element,this._activeLevel.element):this.activeLevelElement.appendChild(t.element),this._activeLevel=t,this._activate(this.activeLevelElement),o.levelStarted(this._activeLevel.name)},i.prototype.backFromLevel=function(){this.runMainMenu()},i.prototype.resumeLevel=function(){this._activeLevel&&(this._activate(this.activeLevelElement),o.levelResumed(this._activeLevel.name))},t.exports=i},{"./analytics":6,"./levelModules":14,"./mainMenu/mainMenu":18,"./saves":19,"./util":21}],21:[function(e,t){var i={};i.addClass=function(e,t){if(void 0!==e.classList)e.classList.add(t);else{var i=e.className.split(" "),s=i.indexOf(t);-1===s&&(i.push(t),e.className=i.join(" "))}return this},i.removeClass=function(e,t){if(void 0!==e.classList)e.classList.remove(t);else{var i=e.className.split(" "),s=i.indexOf(t);-1!==s&&(i.splice(s,1),e.className=i.join(" "))}return this},i.hasClass=function(e,t){if(void 0!==e.classList)return e.classList.contains(t);var i=e.className.split(" ");return-1!=i.indexOf(t)},i.forEach=function(e,t,i){e.length?e.forEach(t,i):Object.keys(e).forEach(function(s){t.call(i,e[s],s)})},i.on=function(e,t,i,s){e.addEventListener(t,i,s)},i.off=function(e,t,i,s){e.removeEventListener(t,i,s)},i.isMobile="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,i.rgbSum=function(e){var t,i,s,n=[0,0,0],o=0;for(i=0;i<e.length;i++){for(t=e[i],s=0;3>s;s++)n[s]+=t.rgb[s]*t.ratio;o+=t.ratio}for(s=0;3>s;s++)n[s]=Math.floor(n[s]/o);return n},i.nullFn=function(){},i.random=function(e){var t=0;e.forEach(function(e){t+=e[1]});for(var i=0,s=e.map(function(e){var s=e[1]/t+i;return i=s,s}),n=Math.random(),o=0,l=0;l<s.length;l++)if(n<=s[l]){o=e[l][0];break}return o},t.exports=i},{}]},{},[1]);